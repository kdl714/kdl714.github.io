<!doctype html>
<!-- v1.2 -->
<html lang="en">
<head>
<meta charset="utf-8">

<style>
  body {
    font-family: serif;
    padding: 24px;
  }

  /* ---------- Pills ---------- */

  .pill-group {
    display: inline-flex;
    border: 1px solid black;
    border-radius: 999px;
    overflow: hidden;
    margin: 6px 0;
  }

  .pill {
    padding: 6px 14px;
    background: white;
    color: black;
    border: none;
    border-right: 1px solid black;
    cursor: pointer;
  }

  .pill:last-child {
    border-right: none;
  }

  .pill.active {
    background: black;
    color: white;
  }

  /* ---------- Roll button ---------- */

  #dicebtn {
    margin-top: 16px;
    padding: 10px 24px;
    font-size: 18px;
    border: 2px solid black;
    background: black;
    color: white;
    cursor: pointer;
    border-radius: 6px;
    transition: transform 0.05s ease, box-shadow 0.05s ease;
  }

  #dicebtn:active {
    transform: translateY(1px);
    box-shadow: inset 0 0 6px rgba(0,0,0,0.4);
  }

  /* ---------- Output ---------- */

  #output {
    margin-top: 24px;
    display: flex;
    gap: 16px;
  }

  .die {
    width: 80px;
    height: 80px;
  }

  .die rect {
    fill: white;
    stroke: black;
    stroke-width: 2;
    rx: 12;
  }

  .die text {
    font-size: 28px;
    dominant-baseline: middle;
    text-anchor: middle;
    fill: black;
    font-weight: bold;
  }

  .winner.adv rect {
    stroke: green;
    filter: drop-shadow(0 0 6px rgba(0,128,0,0.6));
  }

  .winner.dis rect {
    stroke: red;
    filter: drop-shadow(0 0 6px rgba(128,0,0,0.6));
  }

  /* ---------- Roll flash ---------- */

  @keyframes rollFlash {
    0% { background-color: transparent; }
    30% { background-color: #f0f0f0; }
    100% { background-color: transparent; }
  }

  #output.rolling {
    animation: rollFlash 300ms ease;
  }
</style>
</head>

<body>

<!-- Dice (exclusive) -->
<div class="pill-group" id="dice-group">
  <button class="pill active" data-dice="4">d4</button>
  <button class="pill" data-dice="6">d6</button>
  <button class="pill" data-dice="8">d8</button>
  <button class="pill" data-dice="10">d10</button>
  <button class="pill" data-dice="12">d12</button>
  <button class="pill" data-dice="20">d20</button>
</div>

<br>

<!-- Modifier (toggleable) -->
<div class="pill-group" id="mod-group">
  <button class="pill" data-mod="str">STR</button>
  <button class="pill" data-mod="int">INT</button>
  <button class="pill" data-mod="dex">DEX</button>
  <button class="pill" data-mod="wis">WIS</button>
  <button class="pill" data-mod="con">CON</button>
  <button class="pill" data-mod="cha">CHA</button>
</div>

<br>

<!-- Advantage (toggleable) -->
<div class="pill-group" id="adv-group">
  <button class="pill" data-adv="adv">Advantage</button>
  <button class="pill" data-adv="dis">Disadvantage</button>
</div>

<br>

<button id="dicebtn">Roll</button>

<div id="output"></div>

<script>
  const output = document.getElementById("output");

  const mods = {
    str: -1, int: 0, dex: 2,
    wis: 1, con: 0, cha: -2
  };

  // Dice: exclusive
  document.querySelectorAll("#dice-group .pill").forEach(btn => {
    btn.addEventListener("click", () => {
      document.querySelectorAll("#dice-group .pill")
        .forEach(b => b.classList.remove("active"));
      btn.classList.add("active");
    });
  });

  // Mod + Adv: toggleable
  function makeToggle(groupId) {
    document.querySelectorAll(`#${groupId} .pill`).forEach(btn => {
      btn.addEventListener("click", () => {
        btn.classList.toggle("active");
        [...btn.parentElement.children]
          .filter(b => b !== btn)
          .forEach(b => b.classList.remove("active"));
      });
    });
  }

  makeToggle("mod-group");
  makeToggle("adv-group");

  document.getElementById("dicebtn").addEventListener("click", roll);

  function roll() {
    const diceValue = Number(
      document.querySelector("#dice-group .pill.active").dataset.dice
    );

    const modBtn = document.querySelector("#mod-group .pill.active");
    const advBtn = document.querySelector("#adv-group .pill.active");

    const modValue = modBtn ? modBtn.dataset.mod : null;
    const advValue = advBtn ? advBtn.dataset.adv : "NONE";

    const die1 = rollDie(diceValue, modValue);
    const die2 = rollDie(diceValue, modValue);

    output.classList.remove("rolling");
    void output.offsetWidth;
    output.classList.add("rolling");

    output.innerHTML = renderDice(die1, die2, advValue);
  }

  function rollDie(diceValue, modValue) {
    const roll = Math.floor(Math.random() * diceValue) + 1;
    const mod = modValue ? mods[modValue] : 0;
    return { total: roll + mod, display: roll + mod };
  }

  function renderDice(d1, d2, adv) {
    if (adv === "NONE") {
      return svgDie(d1.display);
    }

    let high = d1.total >= d2.total ? d1 : d2;
    let low  = d1.total >= d2.total ? d2 : d1;

    const winner = adv === "adv" ? high : low;
    const loser  = adv === "adv" ? low : high;

    return (
      svgDie(loser.display) +
      svgDie(winner.display, `winner ${adv}`)
