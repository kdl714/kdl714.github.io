<!doctype html>
<!-- v1.3.8.16 -->
<html lang="en">
<head>
<meta charset="utf-8">

<style>
body {
  font-family: serif;
  padding: 24px;
}

/* ---------- Pills ---------- */
.pill-group {
  display: inline-flex;
  border: 1px solid black;
  border-radius: 999px;
  overflow: hidden;
  margin: 6px 0;
}

.pill {
  padding: 6px 14px;
  background: white;
  color: black;
  border: none;
  border-right: 1px solid black;
  cursor: pointer;
}

.pill:last-child { border-right: none; }
.pill.active { background: black; color: white; }

/* ---------- Roll button ---------- */
#dicebtn {
  margin-top: 16px;
  padding: 12px 28px;
  font-size: 18px;
  border: 2px solid black;
  background: black;
  color: white;
  cursor: pointer;
  border-radius: 6px;
}

/* ---------- Output ---------- */
#output {
  margin-top: 24px;
  display: flex;
  gap: 32px;
  align-items: center;
}

.die-container {
  display: flex;
  align-items: center;
  gap: 12px;
}

.die {
  width: 90px;
  height: 90px;
}

.die polygon,
.die rect {
  fill: white;
  stroke: black;
  stroke-width: 2;
}

/* Winner highlight */
.winner.adv polygon,
.winner.adv rect {
  stroke: green;
  filter: drop-shadow(0 0 6px rgba(0,128,0,.6));
}

.winner.dis polygon,
.winner.dis rect {
  stroke: red;
  filter: drop-shadow(0 0 6px rgba(128,0,0,.6));
}

/* Nat 1 / 20 */
.nat1 polygon,
.nat1 rect { fill: #ffcccc; }

.nat20 polygon,
.nat20 rect { fill: gold; }

.die text {
  font-size: 20px;
  font-weight: bold;
  text-anchor: middle;
  dominant-baseline: middle;
}

.mod-total {
  font-size: 16px;
}

/* Roll flash */
@keyframes flash {
  0% { background: transparent; }
  50% { background: #f2f2f2; }
  100% { background: transparent; }
}
#output.rolling { animation: flash .3s ease; }
</style>
</head>

<body>

<div class="pill-group" id="dice-group">
  <button class="pill" data-dice="4">d4</button>
  <button class="pill" data-dice="6">d6</button>
  <button class="pill" data-dice="8">d8</button>
  <button class="pill" data-dice="10">d10</button>
  <button class="pill" data-dice="12">d12</button>
  <button class="pill active" data-dice="20">d20</button>
</div>

<br>

<div class="pill-group" id="mod-group">
  <button class="pill" data-mod="str">STR</button>
  <button class="pill" data-mod="int">INT</button>
  <button class="pill" data-mod="dex">DEX</button>
  <button class="pill" data-mod="wis">WIS</button>
  <button class="pill" data-mod="con">CON</button>
  <button class="pill" data-mod="cha">CHA</button>
</div>

<br>

<div class="pill-group" id="adv-group">
  <button class="pill" data-adv="adv">Advantage</button>
  <button class="pill" data-adv="dis">Disadvantage</button>
</div>

<br>

<button id="dicebtn">Roll</button>

<div id="output"></div>

<script>
const mods = { str:-1, int:0, dex:2, wis:1, con:0, cha:-2 };
const output = document.getElementById("output");

/* Pill behavior */
function exclusive(group) {
  document.querySelectorAll(group + " .pill").forEach(b => {
    b.onclick = () => {
      document.querySelectorAll(group + " .pill").forEach(x => x.classList.remove("active"));
      b.classList.add("active");
    };
  });
}
function toggle(group) {
  document.querySelectorAll(group + " .pill").forEach(b => {
    b.onclick = () => {
      const on = b.classList.contains("active");
      document.querySelectorAll(group + " .pill").forEach(x => x.classList.remove("active"));
      if (!on) b.classList.add("active");
    };
  });
}

exclusive("#dice-group");
toggle("#mod-group");
toggle("#adv-group");

document.getElementById("dicebtn").onclick = roll;

function rollDie(d, modKey) {
  const roll = Math.floor(Math.random() * d) + 1;
  let total = roll;
  let mod = 0;
  let nat1 = false, nat20 = false;

  if (d === 20) {
    if (roll === 1) nat1 = true;
    if (roll === 20) nat20 = true;
  }

  if (!nat1 && !nat20 && modKey) {
    mod = mods[modKey];
    total += mod;
  }

  return { roll, total, mod, nat1, nat20 };
}

function roll() {
  const dice = +document.querySelector("#dice-group .active").dataset.dice;
  const modBtn = document.querySelector("#mod-group .active");
  const advBtn = document.querySelector("#adv-group .active");

  const modKey = modBtn ? modBtn.dataset.mod : null;
  const adv = advBtn ? advBtn.dataset.adv : "NONE";

  const d1 = rollDie(dice, modKey);
  const d2 = adv !== "NONE" ? rollDie(dice, modKey) : null;

  output.classList.remove("rolling");
  void output.offsetWidth;
  output.classList.add("rolling");

  output.innerHTML = render(d1, d2, adv, dice);
}

function render(d1, d2, adv, dice) {
  if (!d2) return dieHTML(d1, dice, true);

  let win = d1.total === d2.total ? d1 :
            adv === "adv" ? (d1.total > d2.total ? d1 : d2)
                          : (d1.total < d2.total ? d1 : d2);

  return dieHTML(d1, dice, d1 === win, adv) +
         dieHTML(d2, dice, d2 === win, adv);
}

function dieHTML(d, dice, show, adv="") {
  let cls = "";
  if (adv && show) cls = `winner ${adv}`;
  if (d.nat1) cls += " nat1";
  if (d.nat20) cls += " nat20";

  return `
  <div class="die-container">
    <svg class="die ${cls}" viewBox="0 0 120 100">
      ${dieShape(dice, d.roll)}
    </svg>
    ${show ? `
      <div>
        ${d.mod ? `<div class="mod-total">Mod: ${d.mod > 0 ? "+" : ""}${d.mod}</div>` : ""}
        <div class="mod-total">Total: ${d.total}</div>
      </div>` : ""}
  </div>`;
}

function dieShape(d, n) {
  if (d === 4) return `
  <g>
  <line stroke="#000" x1="80" id="AB" y2="0" x2="40" y1="30"/>
  <line stroke="#000" y2="0" x1="0" x2="40" id="AD" y1="30"/>
  <line stroke="#000" x2="40" id="BC" x1="80" y2="90" y1="30"/>
  <line stroke="#000" x2="40" id="CD" x1="0" y1="30" y2="90"/>
  <line stroke="#000" x2="40" id="AC" x1="40" y1="0" y2="90"/>
  <text font-family="serif" text-anchor="middle" dominant-baseline="middle" fill="#000" x="30" y="25"> ${n} </text>
  <text font-family="serif" text-anchor="middle" dominant-baseline="middle" fill="#000" x="50" y="25"> ${n} </text>
  </g>`;

  if (d === 6) return `
  <g>
  <line stroke="#000" id="AB" x1="10" y2="10" x2="60" y1="10"/>
  <line stroke="#000" id="BC" x1="60" y1="10" y2="60" x2="60"/>
  <line stroke="#000" id="CD" x1="60" y1="60" y2="60" x2="10"/>
  <line stroke="#000" id="AD" x1="10" y1="10" y2="60" x2="10"/>
  <line stroke="#000" id="AE" x1="10" y1="10" x2="5" y2="35"/>
  <line stroke="#000" x2="5" id="EF" x1="5" y2="35" y1="85"/>
  <line stroke="#000" x1="5" id="DF" x2="10" y2="60" y1="85"/>
  <line stroke="#000" x1="5" id="FG" x2="55" y1="85" y2="85"/>
  <line stroke="#000" x2="55" id="CG" x1="60" y1="60" y2="85"/>
  <text font-family="serif" text-anchor="middle" dominant-baseline="middle" fill="#000" x="35" y="35"> ${n} </text>
  </g>`;

    if (d === 8) return `
  <g>
  <line y2="0" id="AB" stroke="#000" x2="40" y1="60" x1="78"/>
  <line stroke="#000" y2="0" x2="40" id="AB-2" y1="25" x1="80"/>
  <line stroke="#000" id="AB-3" x1="80" y2="60" y1="25" x2="78"/>
  <line y2="0" id="AD" stroke="#000" x2="40" y1="60" x1="2"/>
  <line stroke="#000" y2="0" x1="0" id="AD-2" x2="40" y1="25"/>
  <line stroke="#000" y1="60" x2="0" id="AD-3" y2="25" x1="2"/>
  <line stroke="#000" id="CD" x1="40" y2="60" y1="90" x2="2"/>
  <line stroke="#000" id="BC" x1="40" y2="60" y1="90" x2="78"/>
  <line stroke="#000" id="BD" y1="60" y2="60" x2="2" x1="78"/>
  <text font-family="serif" text-anchor="middle" dominant-baseline="middle" fill="#000" x="40" y="40"> 7 </text>
  </g>`;
  
  if (d === 10) {
  return `
    <g>
    <line y2="0" id="AB" stroke="#000" x1="100" y1="50" x2="50"/>
    <line y2="0" x1="0" id="AD" stroke="#000" y1="50" x2="50"/>
    <line x2="0" stroke="#000" id="CD" x1="50" y2="50" y1="100"/>
    <line stroke="#000" id="BC" y2="50" y1="100" x1="50" x2="100"/>
    <line y2="0" stroke="#000" id="AE" y1="50" x2="50" x1="50"/>
    <line stroke="#000" id="EF" x1="50" y2="55" y1="50" x2="75"/>
    <line stroke="#000" id="F-AB" y1="45" x1="95" x2="75" y2="55"/>
    <line stroke="#000" id="FC" y1="100" x1="50" y2="55" x2="75"/>
    <line id="EG" stroke="#000" x1="50" y1="50" y2="55" x2="25"/>
    <line stroke="#000" id="G-AD" y2="55" x2="25" x1="5" y1="45"/>
    <line stroke="#000" id="GC" y1="100" x1="50" y2="55" x2="25"/>
    <text font-family="serif" text-anchor="middle" dominant-baseline="middle" fill="#000" x="69" y="39"> ${n} </text>
    </g>`;
}

  if (d === 12) return `
  <g>
  <!--outer-->
  <line stroke="#000" id="AB" x1="50" y1="5" x2="76.45" y2="13.59"/>
  <line stroke="#000" id="BC" x1="76.45" y1="13.59" x2="92.8" y2="36.1"/>
  <line stroke="#000" id="CD" x1="92.8" y1="36.1" x2="92.8" y2="63.9"/>
  <line stroke="#000" x2="92.8" y2="63.9" id="DE" x1="76.45" y1="86.41"/>
  <line stroke="#000" x1="76.45" y1="86.41" id="EF" x2="50" y2="95"/>
  <line stroke="#000" y1="86.41" x2="50" y2="95" id="FG" x1="23.55"/>
  <line stroke="#000" y1="86.41" x1="23.55" id="GH" x2="7.2" y2="63.9"/>
  <line stroke="#000" x2="7.2" y2="63.9" id="HI" y1="36.1" x1="7.2"/>
  <line stroke="#000" y1="36.1" x1="7.2" id="IJ" x2="23.55" y2="13.59"/>
  <line stroke="#000" x2="23.55" y2="13.59" id="JK" y1="5" x1="50"/>
  <!--inner-->
  <line fill="none" x1="50" y1="26" x2="72.83" y2="42.59" id="LM" stroke="#000"/>
  <line fill="none" x1="72.83" y1="42.59" x2="64.09" y2="69.41" id="MN" stroke="#000"/>
  <line id="NO" stroke="#000" fill="none" x1="64.09" y1="69.41" x2="35.91" y2="69.41"/>
  <line id="OP" stroke="#000" fill="none" x1="35.91" y1="69.41" x2="27.17" y2="42.59"/>
  <line id="PQ" stroke="#000" fill="none" x1="27.17" y1="42.59" x2="50" y2="26"/>  
  <!--connecting-->
  <line stroke="#000" fill="none" x2="50" y2="26" id="AL" x1="50" y1="5"/>
  <line stroke="#000" fill="none" x2="92.8" y2="36.1" id="CM" x1="72.83" y1="42.59"/>
  <line stroke="#000" fill="none" id="EN" x2="64.09" y2="69.41" x1="76.45" y1="86.41"/>
  <line stroke="#000" fill="none" y2="69.41" y1="86.41" id="GO" x2="35.91" x1="23.55"/>
  <line stroke="#000" fill="none" id="IP" x1="27.17" x2="7.2" y1="42.59" y2="36.1"/>
  <text font-family="serif" text-anchor="middle" dominant-baseline="middle" fill="#000" x="50" y="52"> ${n} </text>
  </g>`;

  
  return `<polygon points="60,10 95,25 110,50 95,75 60,90 25,75 10,50 25,25"/><text x="60" y="60">${n}</text>`;
}
</script>

</body>
</html>
