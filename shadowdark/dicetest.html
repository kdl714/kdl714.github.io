<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">

  <style>
    body {
      font-family: serif;
      padding: 24px;
    }

    .roll {
      margin: 6px 0;
      padding: 6px 10px;
      display: inline-block;
    }

    .winner.adv {
      border: 2px solid green;
    }

    .winner.dis {
      border: 2px solid red;
    }
  </style>
</head>

<body>

  <div>
    <!-- Dice -->
    <input type="radio" name="dice" data-dice="4"> d4
    <input type="radio" name="dice" data-dice="6"> d6
    <input type="radio" name="dice" data-dice="8"> d8
    <input type="radio" name="dice" data-dice="10"> d10
    <input type="radio" name="dice" data-dice="12"> d12
    <input type="radio" name="dice" data-dice="20" checked> d20
    <br>

    <!-- Modifiers -->
    <input type="radio" name="mod" data-mod="str"> STR
    <input type="radio" name="mod" data-mod="int"> INT
    <input type="radio" name="mod" data-mod="dex"> DEX
    <input type="radio" name="mod" data-mod="wis"> WIS
    <input type="radio" name="mod" data-mod="con"> CON
    <input type="radio" name="mod" data-mod="cha"> CHA
    <input type="radio" name="mod" data-mod="NONE" checked> NONE
    <br>

    <!-- Advantage -->
    <input type="radio" name="adv" data-adv="adv"> Advantage
    <input type="radio" name="adv" data-adv="dis"> Disadvantage
    <input type="radio" name="adv" data-adv="NONE" checked> NONE
    <br><br>

    <button id="dicebtn">Roll</button>
  </div>

  <div id="output"></div>

  <script>
    const button = document.getElementById("dicebtn");
    const output = document.getElementById("output");

    const mods = {
      str: -1,
      int: 0,
      dex: 2,
      wis: 1,
      con: 0,
      cha: -2
    };

    button.addEventListener("click", roll);

    function roll() {
      const diceValue = Number(
        document.querySelector('input[name="dice"]:checked').dataset.dice
      );
      const modValue =
        document.querySelector('input[name="mod"]:checked').dataset.mod;
      const advValue =
        document.querySelector('input[name="adv"]:checked').dataset.adv;

      const die1 = rollDie(diceValue, modValue);
      const die2 = rollDie(diceValue, modValue);

      output.innerHTML = renderResults(die1, die2, advValue);
    }

    function rollDie(diceValue, modValue) {
      const roll = Math.floor(Math.random() * diceValue) + 1;
      const mod = modValue === "NONE" ? 0 : mods[modValue];
      const total = roll + mod;

      if (roll === 1 || roll === diceValue) {
        return { total: roll, text: `nat ${roll}` };
      }

      if (mod === 0) {
        return { total, text: `${roll}` };
      }

      const sign = mod > 0 ? "+" : "-";
      return {
        total,
        text: `${roll} ${sign} ${Math.abs(mod)} = ${total}`
      };
    }

    function renderResults(die1, die2, advValue) {
      if (advValue === "NONE") {
        return `<div class="roll">${die1.text}</div>`;
      }

      let winner = die1;
      let loser = die2;

      if (die2.total > die1.total) {
        winner = die2;
        loser = die1;
      }

      return `
        <div class="roll">${loser.text}</div>
        <div class="roll winner ${advValue}">${winner.text}</div>
      `;
    }
  </script>

</body>
</html>
